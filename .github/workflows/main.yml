name: CI

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Set up Java 17
      uses: actions/setup-java@v3
      with:
        distribution: 'zulu'
        java-version: '17'

    - name: Install Xvfb (for headless test execution)
      run: |
        sudo apt-get -y install xvfb
        sudo /usr/bin/Xvfb :0 -screen 0 1280x1024x24 &

    - name: Clean up Chrome temp data (optional)
      run: |
        rm -rf /tmp/chrome-data-${{ github.run_id }}

    - name: Katalon Studio Github Action
      uses: katalon-studio/katalon-studio-github-action@v4.0
      with:
          version: '9.7.5'
          projectPath: '${{ github.workspace }}'
          args: '-retry=0 -testSuitePath="Test Suites/ts01" -browserType="Chrome (headless)" -executionProfile="default" -apiKey="d1e929ac-be0f-4cec-a5fc-f9fd6d7c8485" -orgID=1192683 -testOpsProjectId=1158058 --config -webui.autoUpdateDrivers=true'
